<!DOCTYPE html>
<html lang="zh-hans">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        #hb {
            display:block;
            background: green;
        }

        body {
            margin: 0;
        }

        .tools{
            position: fixed;
            bottom: 0;
            left: 0;    
        }
        
        .tools > #brush {
            display: none;
        }
        .tools.x > #brush {
            display: inline-block;
        }
        .tools.x > #eraser {
            display: none;
        }
    </style>
</head>

<body>
    <canvas id="hb" width=300 height=300 ></canvas>
    <div id='tools' class='tools'>
        <button id='eraser'>橡皮擦</button>
        <button id='brush'>画笔</button>
    </div>
    <script>
        var canvas = document.getElementById('hb');
        var context = canvas.getContext('2d');
        
        autoSetCanvasSize()

        listenToMouse(canvas)

        var eraserEnabled = false
        eraser.onclick = function(){
            eraserEnabled = true
            tools.className = "tools x"
        }
        brush.onclick = function(){
            eraserEnabled = false
            tools.className = "tools"
        }

        /***************/
        function listenToMouse(canvas){
            var using = false;
            var lastPoint = {x:0, y:0}
            canvas.onmousedown = function (dff) {
                var x = dff.clientX;
                var y = dff.clientY;
                using = true
                if(eraserEnabled){
                    context.clearRect(x-5,y-5,10,10)
                }else{
                    if(using){
                        lastPoint.x = x;
                        lastPoint.y = y;
                    }
                }
            }


            canvas.onmousemove = function(dff){
                var x2 = dff.clientX;
                var y2 = dff.clientY;
                if(using){
                    if(eraserEnabled){
                        context.clearRect(x2-5,y2-5,10,10)
                    }else{
                        drawLine(lastPoint.x,lastPoint.y,x2,y2)
                        lastPoint.x = x2
                        lastPoint.y = y2
                    }
                }
            }

            canvas.onmouseup = function(){
                using = false;
            }
        }



        /*划圆*/
        function drawCircle(x, y, radius){
            context.beginPath();
            context.arc(x,y,radius,0,Math.PI * 2);
            context.fill();
        }
        
        /*划线*/
        function drawLine(x1, y1, x2, y2){
            context.beginPath()
            context.strokeStyle = 'black'
            context.lineWith = 10 
            context.moveTo(x1, y1)
            context.lineTo(x2,y2)
            context.stroke()
        }
        
        function autoSetCanvasSize(){
            setCanvasSize()

            window.onresize = function(){
                setCanvasSize()
            }

            function setCanvasSize(){
                var pageWidth = document.documentElement.clientWidth
                var pageHeight = document.documentElement.clientHeight
                canvas.width = pageWidth
                canvas.height = pageHeight
            }
        }        
 
    </script>
</body>

</html>